<?xml version="1.0" encoding="UTF-8"?>
<!-- PRE - PROFILE -->
<Menu Id="Home" Title="Car" OnLoad="Test">
  <Button Type="Intern" Target="loadGameMenu()"><Text Id="game.continue"/></Button>
  <Button Type="Goto" Target="NewGame"><Text Id="game.new"/></Button>
  <Button Type="Goto" Target="Credits"><Text Id="game.about"/></Button>
  <Button Type="Intern" Target="exit()"><Text Id="game.quit"/></Button>
</Menu>
<!-- Menu -->
<Menu Id="NewGame">
  <Text Id="profile.promptname"/>
  <Select Id="Difficulty" Text="Difficulty">
    <Option Value="0"><Text Id="difficulty.easy"/></Option>
    <Option Value="1"><Text Id="difficulty.medium"/></Option>
    <Option Value="2"><Text Id="difficulty.hard"/></Option>
  </Select>
  <Select Id="Locale" Text="Locale">
    <Option Value="en-US">en-US</Option>
    <Option Value="fr-FR">fr-FR</Option>
  </Select>
  <Input Id="Profile"><Text Id="global.name"/></Input>
  <Button Type="Script" Target="CreateProfile"><Text Id="global.create"/></Button>
  <Button Type="Goto" Target="Home"><Text Id="global.back"/></Button>
</Menu>
<Script Id="CreateProfile"><![CDATA[
  createProfile(getInputData("Profile"), getSelectValue("Locale"))
  goTo("Main")
]]></Script>
<!-- Menu -->
<Menu Id="Credits" Title="Game">
  <Script><![CDATA[
    print(getVersion() .. "\n")
  ]]></Script>
  <Sep/>
  <Button Type="Goto" Target="Home"><Text Id="global.back"/></Button>
</Menu>
<!-- GAME -->
<Menu Id="Main" Title="Game">
  <Button Type="Goto" Target="Race"><Text Id="game.race"/></Button>
  <Button Type="Goto" Target="Garage"><Text Id="game.garage"/></Button>
  <Button Type="Goto" Target="Stats"><Text Id="game.stats"/></Button>
  <Button Type="Goto" Target="Options"><Text Id="game.options"/></Button>
  <Button Type="Intern" Target="exit()"><Text Id="game.quit"/></Button>
</Menu>
<!-- Menu -->
<Menu Id="Options" Title="Options" OnLoad="OptionsOnLoad">
  <Select Id="Difficulty" Text="Difficulty">
    <Option Value="0"><Text Id="difficulty.easy"/></Option>
    <Option Value="1"><Text Id="difficulty.medium"/></Option>
    <Option Value="2"><Text Id="difficulty.hard"/></Option>
  </Select>
  <Select Id="Locale" Text="Locale">
    <Option Value="en-US">en-US</Option>
    <Option Value="fr-FR">fr-FR</Option>
  </Select>
  <Input Id="Profile"><Text Id="profile.promptname"/></Input>
  <Sep/>
  <Button Type="Script" Target="ApplyOptions"><Text Id="global.apply"/></Button>
  <Button Type="Goto" Target="Main"><Text Id="global.back"/></Button>
</Menu>
<Script Id="OptionsOnLoad"><![CDATA[
  setSelectValue("Difficulty", getProfileDifficulty())
  setInputData("Profile", getProfileName())
  setSelectValue("Locale", getProfileLocale())
]]></Script>
<Script Id="ApplyOptions"><![CDATA[
  setProfileName(getInputData("Profile"))
  setProfileDifficulty(getSelectValue("Difficulty"))
  setProfileLocale(getSelectValue("Locale"))
  goTo("Main")
]]></Script>
<!-- Menu -->
<Menu Id="Race" Title="Game">
  <Text>Select mode</Text>
  <Sep/>
  <Button Type="Script" Target="StartRace"><Text Id="race.free"/></Button>
  <Text>-<Text Id="race.career"/>-</Text>
  <Sep/>
  <Button Type="Goto" Target="Main"><Text Id="global.back"/></Button>
</Menu>
<Script Id="StartRace"><![CDATA[
  selectCarMenu();
  selectTrackMenu();
  startRace()
]]></Script>
<!-- Menu -->
<Menu Id="Stats" Title='Stats'>
  <Text>Stats du Profile: </Text>
  <Script><![CDATA[
    print(getProfileName())
    pstats = getProfileStats()
  ]]></Script>
  <Sep/>
  <Text> |Courses effectuees: </Text>
  <Script><![CDATA[ print(pstats.races) ]]></Script>
  <Text> |</Text>
  <Text> |Victoires:  </Text>
  <Script><![CDATA[ print(pstats.victories) ]]></Script>
  <Text> |Defaites:   </Text>
  <Script><![CDATA[ print(pstats.losses) ]]></Script>
  <Text> |[V/D Ratio:  ]</Text>
  <Text> |</Text>
  <Text> |Accidents: </Text>
  <Script><![CDATA[ print(pstats.accidents) ]]></Script>
  <Text>#Stats Carriere:</Text>
  <Text> |Credits remportes:</Text>
  <Script><![CDATA[ print(pstats.creditsEarned) ]]></Script>
  <Text> |</Text>
  <Text> |Cars achetees:</Text>
  <Script><![CDATA[ print(pstats.carBought) ]]></Script>
  <Sep/>
  <Button Type='Goto' Target='Main'>Back</Button>
</Menu>
<!-- GARAGE -->
<Menu Id="Garage" Title="Garage" OnLoad="GarageOnLoad">
  <Sep/>
  <Button Type="Script" Target="RepairCar"><Text Id="garage.repair"/></Button>
  <Button Type="Goto" Target="UpgradeCar"><Text Id="garage.upgrade"/></Button>
  <Button Type="Script" Target="SellCar"><Text Id="garage.sell"/></Button>
  <Sep/>
  <Button Type="Goto" Target="Main"><Text Id="global.back"/></Button>
</Menu>
<Script Id="GarageOnLoad"><![CDATA[
  i = 0
  while (i < Garage:size()) do
    car = Garage:get(i)
    addMenuItem(0 + i, "<Button Type='Intern' Target='setEnv(\"Box\", \""..i.."\") goTo(\"Box\")'>[Box " .. i .. "] "..car.manufacturer.." "..car.name .. "</Button>")
    i = i + 1
  end
]]></Script>
<!-- BOX -->
<Menu Id="Box" Title="Garage">
  <Script><![CDATA[
    car = Garage:get(getEnvInt("Box"))
    print("[Box "..getEnv("Box").."] "..car.manufacturer.." "..car.name .. "\n")
    print(" Engine: "..car:getEngine().manufacturer.." "..car:getEngine().name.."\n")
    print(" Spoiler: "..car:getSpoiler().manufacturer.." "..car:getSpoiler().name.."\n")
    print(" Tires: "..car:getTires().manufacturer.." "..car:getTires().name.."\n")
  ]]></Script>
  <Sep/>
  <Button Type="Script" Target="RepairCar"><Text Id="garage.repair"/></Button>
  <Button Type="Goto" Target="UpgradeCar"><Text Id="garage.upgrade"/></Button>
  <Button Type="Script" Target="SellCar"><Text Id="garage.sell"/></Button>
  <Sep/>
  <Button Type="Goto" Target="Main"><Text Id="global.back"/></Button>
</Menu>
<Script Id="RepairCar"><![CDATA[
  alert("not impl");
]]></Script>
<Script Id="SellCar"><![CDATA[
  alert("not impl")
]]></Script>
<!-- Menu -->
<Menu Id="UpgradeCar"  Title="Garage">
  <Script><![CDATA[
    car = Garage:get(getEnvInt("Box"))
    print("[Box "..getEnv("Box").."] "..car.manufacturer.." "..car.name .. "\n")
    print(" Engine: "..car:getEngine().manufacturer.." "..car:getEngine().name.."\n")
    print(" Spoiler: "..car:getSpoiler().manufacturer.." "..car:getSpoiler().name.."\n")
    print(" Tires: "..car:getTires().manufacturer.." "..car:getTires().name.."\n")
  ]]></Script>
  <Sep/>
  <Button Type="Goto" Target="UpgradeEngine"><Text Id="car.engine"/></Button>
  <Button Type="Goto" Target="UpgradeSpoiler"><Text Id="car.spoiler"/></Button>
  <Button Type="Goto" Target="UpgradeTires"><Text Id="car.tires"/></Button>
  <Button Type="Intern" Target="chooseCharmMenu()"><Text Id="car.charm"/></Button>
  <Sep/>
  <Button Type="Goto" Target="Box"><Text Id="global.back"/></Button>
</Menu>
<!-- Menu -->
<Menu Id="UpgradeEngine" Title="Garage" OnLoad="UpgradeEngineOnLoad">
  <Script><![CDATA[
    car = Garage:get(getEnvInt("Box"))
    print("[Box "..getEnv("Box").."] "..car.manufacturer.." "..car.name .. "\n")
    print(" Engine: "..car:getEngine().manufacturer.." "..car:getEngine().name.."\n")
  ]]></Script>
  <Sep/>
  <Sep/>
  <Button Type="Goto" Target="UpgradeCar"><Text Id="global.back"/></Button>
</Menu>
<Script Id="UpgradeEngineOnLoad"><![CDATA[
  i = 0
  while (i < Engines:size()) do
    addMenuItem(2 + i, "<Button Type='Intern' Target='car:buyEngine(Engines[" .. i .. "])'>" .. Engines[i].manufacturer .. " - " .. Engines[i].name .. "</Button>")
    i = i + 1
  end
]]></Script>
<!-- Menu -->
<Menu Id="UpgradeSpoiler" Title="Garage"  OnLoad="UpgradeSpoilerOnLoad">
  <Script><![CDATA[
    car = Garage:get(getEnvInt("Box"))
    print("[Box "..getEnv("Box").."] "..car.manufacturer.." "..car.name .. "\n")
    print(" Spoiler: "..car:getSpoiler().manufacturer.." "..car:getSpoiler().name.."\n")
  ]]></Script>
  <Sep/>
  <Sep/>
  <Button Type="Goto" Target="UpgradeCar"><Text Id="global.back"/></Button>
</Menu>
<Script Id="UpgradeSpoilerOnLoad"><![CDATA[
  i = 0
  while (i < Spoilers:size()) do
    addMenuItem(2 + i, "<Button Type='Intern' Target='car:buySpoiler(Spoilers[" .. i .. "])'>" .. Spoilers[i].manufacturer .. " - " .. Spoilers[i].name .. "</Button>")
    i = i + 1
  end
]]></Script>
<!-- Menu -->
<Menu Id="UpgradeTires" Title="Garage"  OnLoad="UpgradeTiresOnLoad">
  <Script><![CDATA[
    car = Garage:get(getEnvInt("Box"))
    print("[Box "..getEnv("Box").."] "..car.manufacturer.." "..car.name .. "\n")
    print(" Tires: "..car:getTires().manufacturer.." "..car:getTires().name.."\n")
  ]]></Script>
  <Sep/>
  <Sep/>
  <Button Type="Goto" Target="UpgradeCar"><Text Id="global.back"/></Button>
</Menu>
<Script Id="UpgradeTiresOnLoad"><![CDATA[
  i = 0
  while (i < Tires:size()) do
    addMenuItem(2 + i, "<Button Type='Intern' Target='car:buyTires(Tires[" .. i .. "])'>" .. Tires[i].manufacturer .. " - " .. Tires[i].name .. "</Button>")
    i = i + 1
  end
]]></Script>